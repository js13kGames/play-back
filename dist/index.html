<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><style>body{margin:0;padding:0}#c,#h,#l,#o{position:absolute;top:0;left:0;bottom:0;right:0;margin:auto;box-sizing:border-box}#h,#l,#o{color:#fff;background:rgba(0,0,0,.5);opacity:0;transition:opacity .5s}#l,#o{text-align:center;font:9vh fantasy;padding-top:40vh}#h{padding:9vh;font:15px fantasy}</style><canvas id="c"></canvas><div id="o"><b>Space to Retry</b></div><div id="h"></div><div id="l"></div><script>let aa=(a,b)=>a.reduce((e,d,f)=>e&&d==b[f],!0),I=(a,b)=>{b=a.indexOf(b);0<=b&&a.splice(b,1)},ca=(a,b,e)=>{a=[0,0,a,b];const d=[];ba(a,a,(f,g)=>{g||d.push([]);d[f].push(e(f,g))});return d};const da=[0,7E-5],ea=[1209,1336,1477],fa=[697,770,852,941];
let ha=a=>{const [b,e,d]=a;return`hsl(${b},${e}%,${d}%)`},ja=(a,b,e,d,f)=>{ia(a,b,e,b.ha,d,f)},ia=(a,b,e,d,f,g)=>{d&&d.forEach(k=>{a.save();ka(a,k.H,1);g.forEach(q=>ka(a,b.Ia[q.Ea][k.id],q.progress));ia(a,b,e,k.gb,f,g);null!=k.I&&b.images[k.I].forEach(q=>{a.beginPath();var p;if(8>q.length){let [m,u,w,x,r,n,v]=q,t,z,y;n&&(n.length?[p,t,z,y]=n:p=t=z=y=n);p=p||0;t=t||0;z=z||0;y=y||0;a.moveTo(m+p,u);a.arcTo(m+w,u,m+w,u+t,t);a.arcTo(m+w,u+x,m+w-z,u+x,z);a.arcTo(m,u+x,m,u+y,y);a.arcTo(m,u,m+p,u,p);q=r;
p=v}else{let [m,u,w,x,r,n,v,t]=q;a.moveTo(m,u);a.lineTo(w,x);a.lineTo(r,n);a.lineTo(m,u);q=v;p=t}a.fillStyle=ha(e[q]);a.fill();null!=p&&(a.strokeStyle=ha(e[p]),a.lineWidth=1,a.stroke())});ia(a,b,e,k.$,f,g);f(a,k);a.restore()})},ka=(a,b,e)=>{b&&b.forEach(d=>{switch(d.B){case 0:a.scale(1-(1-d.U)*e,1-(1-d.V)*e);break;case 1:a.translate(d.D*e,d.F*e);break;case 2:a.translate(d.Fa||0,d.Ga||0);a.rotate(d.rotation*e);a.translate(-d.Fa||0,-d.Ga||0);break;case 3:a.globalAlpha=d.opacity*e}})};
const O=[{K:[48]},{K:[49]},{K:[50]},{K:[51]},{K:[52]},{K:[53]},{K:[54]},{K:[55]},{K:[56]},{K:[57]},{name:"unlock"},{K:[87,38],name:"up"},{K:[83,40],name:"down",pa:1},{K:[65,37],name:"left",ca:2,pa:1},{K:[68,39],name:"right",ca:2,pa:1},{K:[74,32],name:"jump"},{name:"say"},{name:"open"},{K:[188],Ha:">",name:"rewind",ca:9,pa:1},{K:[190],Ha:"<",name:"fast forward",ca:9,pa:1},{name:"stop"},{K:[80],name:"pick up",ca:6},{K:[76],name:"drop",ca:8},{K:[84],name:"throw",ca:7},{K:[73],name:"insert",ca:5},{K:[75],
name:"eject"},{K:[77],name:"play",ca:9},{K:[82],name:"record",pa:1},{K:[72],name:"help"},{name:"save"}],la={},ma={},pa=a=>{O.forEach((b,e)=>{b.K&&b.K.forEach(d=>la[d]=e);ma[e]=b.ca;b.utterance=na(a,oa(e))})},oa=a=>{a=O[a];return a.name||a.Ha||String.fromCharCode(a.K[0])};
let Q=(a,b,e)=>{const d=a.inputs;a=a.va;const f=O[b].pa,g=d.X[b],k=d.xa[b]||0;return(!a||a.has(b))&&g&&(f||k<g)?(d.xa[b]=e,1):0},qa=(a,b,e,d)=>{const f=a.inputs;!d&&(a=a.N.aa[ma[b]])&&(d=a.M);if(d)return b=e-f.X[b],(b/d|0)!=((b+19)/d|0)};const ra=[[-1,0],[0,-1],[1,0],[0,1]];
let sa=(a,b)=>R(a,b,([e,d],[f,g])=>e>=f&&e<f+g||f>=e&&f<e+d),ta=(a,b)=>{a=sa(a,b);return a[0]&&a[1]},va=(a,b)=>R(a,b,([e,d],[,f])=>[Math.max(0,Math.floor(e)),Math.min(Math.floor(e+d),f-1)]),ba=(a,b,e)=>{if(a){const [[d,f],[g,k]]=va(a,b);for(a=d;a<=f;a++)for(b=g;b<=k;b++)e(a,b)}};const wa=(a,b)=>0==b%2,xa=(a,b)=>0<b%2;let R=(a,b,e,d=[],f=0)=>{d[f]=e(a.filter(wa),b.filter(wa));d[f+1]=e(a.filter(xa),b.filter(xa));return d};
const za=(a,b,e)=>(d,f,g=1)=>{f=a.currentTime+.3*g;const k=a.createOscillator(),q=a.createOscillator();k.frequency.value=b/(g*d);q.frequency.value=e/(g*d);const p=a.createGain();p.gain.value=d/9;d=a.createBiquadFilter();d.type="lowpass";d.frequency.value=8E3/g;k.connect(p);q.connect(p);p.connect(d);d.connect(a.destination);k.start();q.start();k.stop(f);q.stop(f);k.onended=()=>{[p].map(ya)}};
let S=(a,b,e,d,f,g,k,q,p)=>(m,u,w=1)=>{u=a.currentTime;let x=a.createOscillator();x.frequency.setValueAtTime(f/w,u);x.frequency.linearRampToValueAtTime(g/w,u+b*w);x.type=d;let r=a.createGain();Aa(r,u,e*m,.05*m,0*w,.2*b*w,b*w);let n;q&&(m=a.createOscillator(),m.frequency.value=p/w,m.type=q,n=a.createGain(),n.gain.value=-999,m.connect(n),n.connect(x.detune),m.start(),m.stop(u+b));k?(m=a.createBiquadFilter(),m.type=k<f?"highpass":"lowpass",m.Q.value=0,m.frequency.value=k/w,x.connect(m),m.connect(r)):
x.connect(r);r.connect(a.destination);x.start();x.stop(u+b);x.onended=function(){[r].map(ya)}};const ya=a=>{a&&a.disconnect()},Aa=(a,b,e,d,f,g,k)=>{a.gain.value=0;a.gain.setValueAtTime(0,b);a.gain.linearRampToValueAtTime(e,b+f);a.gain.linearRampToValueAtTime(d,b+g);a.gain.linearRampToValueAtTime(0,b+k)};
function Ba(a,b){var e=a.sampleRate,d=.05*e|0,f=a.createBuffer(1,d,e);for(e=f.getChannelData(0);d--;)e[d]=2*Math.random()-1;return g=>{var k=a.createBufferSource();k.buffer=f;k.loop=!0;var q=a.createBiquadFilter();q.type="lowpass";q.Q.value=0;q.frequency.value=b;var p=a.createGain();Aa(p,a.currentTime,.1*g,.05*g,.01,.05*.2,.05);k.connect(q);q.connect(p);p.connect(a.destination);k.start();k.stop(a.currentTime+.05);k.onended=function(){p&&p.disconnect()}}}
const na=(a,b)=>{let e=.2*b.length,d=a.sampleRate;var f=a.createBuffer(1,e*d|0,d),g=f.getChannelData(0);Ca(g,b,d);return k=>{var q=a.createBufferSource();q.buffer=f;var p=a.createGain();p.gain.value=.1*k;q.connect(p);p.connect(a.destination);q.start();q.stop(a.currentTime+e);q.onended=function(){p&&p.disconnect()}}};
var Da={o:[12,15,0,10,10,0,3,6],i:[5,56,0,10,10,0,3,3],j:[5,56,0,10,10,0,1,3],u:[5,14,0,10,10,0,3,3],a:[18,30,0,10,10,0,3,5],e:[14,50,0,10,10,0,3,15],w:[3,14,0,10,10,0,3,1],v:[2,20,0,20,10,0,3,3],z:[5,28,80,10,5,10,3,3],b:[4,0,0,10,0,0,1,2],d:[4,40,80,10,10,10,1,2],m:[4,20,0,10,10,0,3,2],n:[4,40,0,10,10,0,3,2],r:[3,10,20,30,8,1,3,3],l:[8,20,0,10,10,0,3,5],g:[2,10,26,15,5,2,2,1],f:[8,20,34,10,10,10,3,4,1],h:[22,26,32,30,10,30,1,10,1],s:[80,110,0,80,40,0,3,5,1],p:[4,10,20,5,10,10,1,2,1,1],t:[4,20,40,
10,20,5,1,3,1,1],k:[20,80,0,10,10,0,1,3,1,1]};
function Ca(a,b,e){for(var d=0,f=0;f<b.length;f++){var g=b.charAt(f),k=Da[g];if(k){g=k[7];for(var q=e/15*k[6],p=0;3>p;p++){var m=k[p],u=50/e*m;if(m)for(var w=m=0,x=1-10*Math.PI/e*k[p+3],r=d,n=0,v=0;v<q;v++){var t=Math.random()-.5;k[8]||(n=120*Math.PI/e*v,t=.5-(n-Math.floor(n/(2*Math.PI))*Math.PI*2)/(2*Math.PI),n=0);t=t+2*Math.cos(2*Math.PI*u)*m*x-w*x*x;w=m;m=t;n=t=.75*n+t*g;t=t/128-1;a[r++]=a[r]/2+t;a[r++]=a[r]/2+t}}d+=3*q/4<<1;k[9]&&(d+=q&16777214)}else if(" "==g||"\n"==g)d+=Math.floor(.2*e)}}
const T=(a,b=30,e=60)=>{const d=[[a,b,e+9],[a,b-9,e],[a,b,e-9]];return(f,g,k)=>[{id:k(),N:Ea,ia:d,R:2,P:0,da:-1,C:[f,g,1,1]}]},Ia=a=>(b,e,d)=>[{id:d(),R:3,P:2,da:16776975,C:[b+a+0,e+1-1,1,1],T:[0,0,0,0],oa:1,O:[0,0,0,0,0],Y:2,G:[0,0],N:Fa,ia:Ga}],Ka=()=>{const a=[[50,80,49],[50,71,40],[50,80,31]],b=Ja();return(e,d,f)=>[{id:f(),N:b,ia:a,R:8,P:0,da:-1,C:[e,d,3,1],ja:0,T:[0,0,0,0],Va:1,J:new Map,W:0,ba:0,inputs:{xa:{},X:{}},O:[0,0,0,0,0],oa:0,Y:0,ta:[],G:[0,0]}]},Oa=a=>{var b=[60,80,70];const e=a&&La(a,
b);return(d,f,g)=>{const k=e&&e(d,f,g);return[{N:Ma,Ta:1,ja:0,C:[d+0,f+1-.75,1,.75],T:[0,0,0,0],P:6,da:0,oa:0,J:new Map([[1,k&&k[0]]]),id:g(),inputs:{xa:{},X:{}},R:6,O:[0,0,0,0,0],W:0,ba:1,Y:0,ia:Na,G:[0,0],Da:1,wa:0,ta:[]}]}},Ra=()=>(a,b,e)=>[{R:1,N:Pa,ia:Qa,C:[a+(1-.9)/2,b+1-.9,.9,.9],da:11145103,P:5,oa:1,id:e(),O:[0,0,0,0,0],Y:1,Na:0,Z:0,G:[0,0],ja:.002,T:[0,0,0,0],orientation:0,qa:0,inputs:{xa:{},X:{}},J:new Map([[7,void 0]]),W:5,ba:7,la:[],ib:1}],Sa=a=>(b,e,d)=>a.reduce((f,g)=>[...f,...g(b,e,
d)],[]),Va=()=>{const a=Ta(),b={r:T(0),y:T(50,80,40),g:T(120),c:T(180),b:T(240),p:T(300),w:T(0,0,90),k:T(0,0,20),a:Ia(0),"^":a},e=[[Ua(Object.assign({},b),"yyyyyyyyyyyyyyyyyyy                yy                yy                yy                yy                yy                yy                yy                yy                yy                yy                 yy   yyyyyyyyyyyyy",[60,20,90]),Ua(Object.assign({},b),"yyyyyyyyyyyyyyyyyyy                yy                yy                yy                yy                yy                yy                yy                yy                yy                y                 yyyyyyyyyyyyyyyyyyy",
[60,20,80])],[Ua(Object.assign({},b,{1:Oa([,,14,,,,]),2:Oa([15,,,,,,]),3:Oa([,,,,,12]),A:Ia(.1)}),"yy   yyyyyyyyyyyyyyyy               y    1            y         ^       yyyyyyyyyyyyyyyyyyy                 yyA           2   yy yy             y   yyyyyyyyyyyyyyyy yy             yy     3         yyy^              yyyyyyyyyyyyyyyyyyy",[30,20,60]),Ua(Object.assign({},b,{1:Oa([,,,13,,,]),2:Oa([13,,13,,13,,13,,13,,13,,13,,14,,14,,14,,14,,14,,14,,14,,]),3:Sa([Ra(),a]),4:Ka()}),"yyyyyyyyyyyyyyyyyy                 y                 y                 yyyyyyyyyyyyy     y              1  y                 y     a      4    yyyyyyyyyyyyyyyyyyy                 yyyy            2 yyyy^^^^^^^34     yyyyyyyyyyyyyyy   y",
[30,20,60])]];return{Wa:(d,f,g)=>e[f][d](d,f,g),width:2,height:2,cb:2,eb:3,ab:0,bb:1}},Ua=(a,b,e)=>{const d=b.length/18|1;return(f,g,k)=>{const q={ya:[],backgroundColor:e,C:[f,g,18,d],Xa:da,Ra:ca(18,d,()=>[]),ua:[]};b.split("").forEach((p,m)=>{(p=a[p])&&p(m%18,m/18|0,k).forEach(u=>U(q,u))});return q}},Ta=()=>(a,b,e)=>{e=e();{var d=[];const f=4*Math.random()|8;for(let g=0;g<=f;g++){const k=g/f-.5;d.push({I:0,H:[{B:1,D:32*(g+(2*Math.random()-1))/f-16-3*k,F:14},{B:0,U:(Math.random()+2)/3,V:(Math.random()+
2.5-Math.abs(k))/2},{B:2,rotation:Math.PI*(Math.random()-.5)/9+k*Math.PI/9}]})}d={width:32,height:8,images:[[[0,-12,4,0,-4,0,0,1]]],ha:d}}return[{id:e,N:d,ia:Wa,R:7,P:1,da:-1,C:[a+0,b+1-.25,1,.25]}]},La=(a,b)=>{const e=[b,[0,0,25],[0,0,100]];return(d,f,g)=>[{R:5,N:Xa,ia:e,C:[d+(1-.42)/2,f+1-.27,.42,.27],P:3,da:3855,oa:1,id:g(),O:[0,0,0,0,0],Y:.05,T:[0,0,0,0],G:[0,0],Pa:.4,orientation:0,qa:0,hb:[...a]}]};
let Za=(a,b,e,d,f,g)=>{if(g){V(a,b);let k=b.timeRemaining-f;b.timeRemaining=f;R(b.C,b.G,Ya(k),b.C)}b.G[d]+=e;[...b.fa,...b.ea].forEach(k=>!d&&Za(a,k,e,d,f,1));g&&W(a,b)},$a=a=>{if(a.T){const b=a.timeRemaining;b?(R(a.C,a.G,([e],[d])=>e+Math.min(0,d*b)-1E-7,a.T),R(a.C,a.G,([,e],[d])=>e+Math.abs(d*b)+2E-7,a.T,2)):a.T=[...a.C]}},X=(a,b,e)=>{a&&b&&a.G&&b.G&&(I(a.fa,b),I(a.ea,b),e?(a.ea.push(b),b.S=a):b.S==a&&(b.S=void 0))},Y=a=>a.Y&&[...a.ea,...a.fa].reduce((b,e)=>b+Y(e),a.Y)||0,Ya=a=>([b],[e])=>b+e*a,
ab=(a,b,e)=>{if(b.G&&b.timeRemaining>e){V(a,b);const d=b.timeRemaining-e;b.timeRemaining=e;R(b.C,b.G,Ya(d),b.C);W(a,b)}},bb=(a,b,e,d,f,g)=>{const k=ma[b],q=f();!a.ma.has(k)&&q&&(null!=a.N.aa[k]?a.ma.set(k,{resolve:p=>{f()==q&&(g(q,p),Z(a,b,e))},startTime:d}):(g(q,d),Z(a,b,e)))},Z=(a,b,e,d)=>{(e=e[b])&&(d?a.ta.unshift(b):e(a.Y||1))},db=(a,b,e,d)=>{const f=new Set;cb(a,b,g=>g.forEach(k=>{!f.has(k.id)&&ta(d&&k.T||k.C,b)&&(e(k),f.add(k.id))}))},cb=(a,b,e)=>{ba(b,a.C,(d,f)=>{e(a.Ra[d][f],d,f)})},U=(a,
b,e)=>{e&&R(e,b.C,([d],[f])=>f+d,b.C);a.ya.push(b);b.G&&a.ua.push(b);W(a,b);e&&[...b.ea,...b.fa].forEach(d=>U(a,d,e))},W=(a,b)=>{b.ka||($a(b),cb(a,b.T||b.C,e=>e.push(b)))},eb=(a,b,e)=>{I(a.ya,b);(b.G||b.N)&&I(a.ua,b);V(a,b);e&&[...b.ea,...b.fa].forEach(d=>eb(a,d,1))},V=(a,b)=>{cb(a,b.T||b.C,e=>{I(e,b)})};
const gb=(a,b,e)=>{const [d,f]=b.La,g=[d-0,f-0,0,0],k=[0,0,...b.size];ba(g,k,(q,p)=>{var m=d==q&&f==p;m=fb(a,b.Qa[q][p],b.na,m?b.Ya:{},m&&e);const [u,w]=b.size;m.forEach((x,r)=>{const n=ra[r],v=q+n[0],t=p+n[1];if(0<=v&&0<=t&&v<u&&t<w){const z=b.Qa[v][t];x.forEach(y=>{let F=1;0==y.R&&(b.La=[v,t],F=0);const E=R([...n,...z.C],y.C,([D,,J],[P,A])=>0<D?1-A+F-P:0>D?J-1-F-P:0);U(z,y,E)})}})});b.na+=19},hb=(a,b)=>{for(;a;)if(a=a.S,a==b)return 1},ib=(a,b)=>(hb(a,b)||0)-(hb(b,a)||0)||b.C[1]-a.C[1],fb=(a,b,e,
d,f)=>{b.ua.sort(ib);for(var g of b.ua)jb(g,b,e,d);let k=19;for(;;){let r=k,n,v,t;b.ua.forEach(B=>{ab(b,B,k);B.G&&!B.ka&&db(b,B.T,M=>{if(M!=B&&(M!=n||B!=v)){ab(b,M,k);var K=R(B.G,M.G||[0,0],([G],[N])=>G-N);let [L,H]=R([...K,...B.C],M.C,([G,N,ua],[Ha,mb])=>{if(0<G)return(Ha-(N+ua))/G;if(0>G)return(N-(Ha+mb))/-G});if(null!=L||null!=H){let G,N;(null==H||L>=H)&&0<=L?(G=L,N=0<K[0]?2:0):(null==L||H>L)&&0<=H&&(G=H,N=0<K[1]?3:1);K=B.da>>4*M.P+N&M.da>>4*B.P+(N+2)%4&1;if(null!=G&&G<=r&&K){var C=Ya(G);K=R(B.C,
B.G,C,[...B.C]);C=R(M.C,M.G||[0,0],C,[...M.C]);sa(K,C)[(N+1)%2]&&(r=G,n=B,v=M,t=N)}}}},1)});if(!n)break;k-=r;V(b,n);V(b,v);d=v;n.ga!=v&&(n.ga=void 0);v.ga!=n&&(v.ga=void 0);var q=n.O[(t+2)%4]<e&&d.O&&d.O[t]<e;const z=n.G,y=d.G||[0,0];g=t%2;const F=(t+2)%4;var p=(g+1)%2,m=Ya(r);R(n.C,z,m,n.C);R(v.C,y,m,v.C);m=Y(n);const E=Y(d);var u;if(n.Aa&&d.Aa)var w=u=0;else u=n.Aa,w=d.Aa;u=E&&!u?m||1:0;w=m&&!w?E||1:0;u||w||(u=w=1);n.O[t]=e+k;const D=z[g]-y[g];p&&n.S!=d.S&&(w&&(0>D&&0==t||0<D&&2==t||n.S==v)&&X(n.S,
n),u&&(0>D&&2==t||0<D&&0==t||d.S==n)&&X(d.S,d));p=kb(n,v,e+r,t);const J=kb(v,n,e+r,F),P=Math.max(n.Pa||.1,d.Pa||.1),A=(y[g]*w+z[g]*u)/(u+w);p&&Za(b,n,(q?A-w*P*D/(u+w):0<z[g]&&2>t||0>z[g]&&1<t?z[g]:0)-n.G[g],g,k);J&&(q=q?A+u*P*D/(u+w):0<y[g]&&1<t||0>y[g]&&2>t?y[g]:0,d.G&&(d.O[F]=e+k,Za(b,d,q-d.G[g],g,k)));p&&J&&(3==t&&m&&w&&X(v,n,1),1==t&&E&&u&&X(n,v,1));d.timeRemaining=n.timeRemaining=k;W(b,n);W(b,v)}b.ya.sort((r,n)=>n.P-r.P);a.fillStyle=ha(b.backgroundColor);a.fillRect(0,0,b.C[2],b.C[3]);let x=[[],
[],[],[]];b.ya.forEach(r=>{6==r.R&&r.G[1]&&console.log("it;s moving!");r.O&&r.O[3]+40<e&&!r.sa&&(r.sa=3);r.ga&&(r.O[4]=e+19,X(r.ga,r,1));ab(b,r,0);var n=R(r.C,b.C,([v,t],[z,y])=>z+Math.floor((v+t/2)/y));if(!r.S&&!aa(n,b.C)){if(!r.ka){const [v,t]=b.C,[z,y]=n,F=z-v,E=y-t;n=ra.findIndex(([D,J])=>D==F&&J==E);0<=n&&x[n].push(r)}eb(b,r,1)}if(f){a.save();const [v,t,z]=r.C;a.translate(v+z/2,t);lb(a,r,e+19);a.restore()}});return x},lb=(a,b,e,d=1,f=1)=>{const [,,g,k]=b.C;if(b.N){if(b.za!=b.sa){var q=b.N.aa&&
b.N.aa[b.za];b.fb=q&&q.M||0;b.za=b.sa;b.Ua=e}q=1;null!=b.orientation&&(q=2*Math.min(1,(e-b.qa)/150)-1,q=0<q?Math.max(.2,q):Math.min(-.2,q),q=b.orientation?q:-q);const u=g/(b.N.width*d),w=k/(b.N.height*f);a.save();a.scale(u*q,w);if(b.za&&(d=b.N.aa&&b.N.aa[b.za])){var p=e-b.Ua;var m=b.fb;m<d.M&&(p-=m);0<=p?(m=Math.floor(p/d.M),d.repeat?(f=d.L.length*d.M,Math.floor(m/d.L.length)>=d.repeat&&(m=d.L.length-1),p=Math.min(p-m*d.M,f)):(p-=m*d.M,m%=d.L.length),p/=d.M,m=d.L[m]):(p=1-p/m,m=d.L[d.L.length-1])}b.Ka!=
m&&(b.Oa=b.Ka,b.Ka=m);const x=[];b.ma&&b.ma.forEach((r,n)=>{n=b.N.aa[n];r=(e-r.startTime)/n.M;let v,t;r<n.L.length?(v=r|0,r-=v,t=v-1):(v=n.L.length-1,r=n.L.length-r+1,t=-1);x.push({Ea:n.L[v],progress:r});0<=t&&x.push({Ea:n.L[t],progress:1-r})});null!=m&&x.unshift({Ea:m,progress:p});null!=b.Oa&&1>p&&x.unshift({Ea:b.Oa,progress:1-p});ja(a,b.N,b.ia,(r,n)=>{(n=b.J&&b.J.get(n.id))&&lb(r,n,e,u,w)},x);a.restore()}else a.fillStyle=b.S?"blue":"black",a.fillRect(-g/2,0,g,k);b.Ba&&b.Ma>e-3E3&&(p=b.Ba.slice(-1).map(oa).join(""),
d=a.measureText(p).width,m=d+.4,d=-d/2-.2,f=1-(e-b.Ma)/3E3,a.globalAlpha=f*f,a.beginPath(),a.moveTo(d+.2,-1.3),a.arcTo(d+m,-1.3,d+m,-1.1,.2),a.arcTo(d+m,-.4,d+m-.2,-.4,.2),a.lineTo(.1,-.4),a.lineTo(0,-.2),a.lineTo(-.1,-.4),a.arcTo(d,-.4,d,-1.1,.2),a.arcTo(d,-1.3,d+.2,-1.3,.2),a.fillStyle="#fff",a.fill(),a.strokeStyle=a.fillStyle="#333",a.stroke(),a.globalAlpha=f,a.fillText(p,0,-.2-.4),a.globalAlpha=1)},jb=(a,b,e,d)=>{V(b,a);var f=a.J&&a.J.get(a.ba);f=f&&f.hb;if(a.ta&&a.ta.length&&(e/1E3|0)<((e+19)/
1E3|0)){const y=a.ta.pop();var g=O[y].utterance;const [,,F,E]=b.C,D=ca(F,E,()=>0),J=[[a.C[0]|0,a.C[1]|0]];for(;J.length;){const [A,B]=J.pop();if(0<=A&&0<=B&&A<F&&B<E&&!D[A][B]){const M=[A,B,1,1];b.Ra[A][B].find(K=>ta(K.C,M)&&(0==K.P||2==K.P))?D[A][B]=-1:(D[A][B]=1,ra.forEach(([K,C])=>{J.push([A+K,B+C])}))}}let P;b.ua.forEach(A=>{const [B,M]=A.C;0<D[B|0][M|0]&&(P=P||0==A.R,A.la&&A!=a&&(A.la.push(y),A.jb=e),A.va&&!A.va.has(y)&&(A.va.add(y),A.$a=y,A.Za=e))});P&&(a.Ba=a.Ba||[],a.Ba.push(y),g(a.Y||1,1),
a.Ma=e)}a.ma=a.ma||new Map;a.ma.forEach((y,F)=>{const E=a.N.aa[F],D=y.startTime+E.M*E.L.length;D<e+19&&(D>=e&&y.resolve(e),D+E.M<e+19&&a.ma.delete(F))});a.ga=void 0;a.G&&(a.timeRemaining=19,R(a.G,b.Xa,([y],[F])=>y+F*a.oa*19,a.G),a.G=a.G.map(y=>Math.min(Math.max(y,-.015),.015)));g=e-a.O[3];var k=e-a.O[4],q=Math.min(g,k);let p=[0,0];var m=a.orientation;let u;let w;if(a.G){a.fa&&a.fa.forEach(y=>X(y.S,y));if(a.S){p=a.S.G||p;var x=a.S;m=null!=x.orientation&&x.qa>a.qa?x.orientation:m}a.fa=a.ea||[];a.ea=
[]}let r=m;if(a.inputs&&!a.ka){var n=a.inputs;let y,F;var v;switch(a.R){case 1:if(a.Na<e){var t=0;m=a.Z;for(var z;!t;)switch(x=m,m=x+1,x=a.la&&a.la.pop()||(f&&x<f.length?f[x]:20),n.X={[12]:1},x){case 13:t=(z||1)/a.ja;n.X[13]=e;break;case 14:t=(z||1)/a.ja;n.X[14]=e;break;case 20:t=1E3*(z||1);break;case 18:case 19:n.X[x]=e;t=200*(z||1);break;default:z=10*(z||0)+x}a.Na=e+t;a.Z=m}break;case 0:Q(a,28,e)&&(a.Ja=!a.Ja)}n=Q(a,13,e);t=Q(a,14,e);q=100>=q;m=Y(a)||1;z=m<2*a.Y;m=a.ib?a.ja:a.ja/m;19>g&&(v=1);if(a.Sa||
q)a.G[0]=(t-n)*m+p[0],n?(q&&(v=2,qa(a,13,e)&&Z(a,13,d)),r=0):t&&(r=1,q&&(v=2,qa(a,14,e)&&Z(a,14,d)));F=Q(a,11,e);y=Q(a,15,e);m=!Q(a,12,e)&&(19<g||F);u=Q(a,21,e);const E=Q(a,22,e);x=Q(a,23,e);const D=Q(a,24,e),J=Q(a,25,e),P=Q(a,26,e);w=Q(a,27,e);n=Q(a,18,e);t=Q(a,19,e);a.J.get(a.ba)&&(n?(v=9,qa(a,18,e,200)&&0<a.Z&&(a.Z--,Z(a,18,d))):t?(v=9,qa(a,19,e,200)&&a.Z<f.length&&(a.Z++,Z(a,19,d))):w&&(v=9,a.ra||(a.wa||(a.wa=e),Z(a,27,d)),a.ra=!0));w||(a.ra=!1);let [A,B,M]=a.C;y&&q&&z&&(a.G[1]=-.014,a.O[3]=0,
a.O[4]=0,Z(a,15,d),g=20);F&&19>=k&&(a.G[1]=-.011,a.O[4]=0,g=20);E&&a.J&&bb(a,22,d,e,()=>a.J.get(a.W),C=>{C.G=[0,0];a.J.delete(a.W);R(a.C,C.C,([L,H],[,G])=>L+(H-G)/2,C.C);U(b,C)});D&&a.J&&bb(a,24,d,e,()=>!a.J.has(a.ba)&&a.J.get(a.W),C=>{a.J.set(a.ba,C);a.J.delete(a.W)});J&&a.J&&(k=a.J.get(a.ba))&&(q=Y(k),k.G=[3E-4*(r-.5)/q,-3E-4/q],a.J.delete(a.ba),R(a.C,k.C,([C,L],[,H])=>C+(L-H)/2,k.C),k.orientation=a.orientation,U(b,k),Z(a,25,d));x&&bb(a,23,d,e,()=>a.fa[0]||a.ea[0]||a.J&&a.J.get(a.W),C=>{const L=
Y(C);C.G=[.02*(2*r-1)/L,-.02/L];a.J.get(a.W)==C&&(a.J.delete(a.W),R(a.C,C.C,([H,G],[,N])=>H+(G-N)/2,C.C),C.orientation=a.orientation,U(b,C));X(a,C)});P&&bb(a,26,d,e,()=>a.J.get(a.ba),(C,L)=>{a.Z=a.Z||0;a.Da=!a.Da;a.wa=L});a.Aa=19<g&&a.Y;let K;if(m&&0<a.G[1]){const C=A+M*r;let L=0;db(b,[C-.15,B-.15,.3,.3],H=>{if(2==H.R||3==H.R||6==H.R){L++;const [G,N,ua]=H.C;(.075>Math.abs(G+(r+1)%2*ua-C)||6==H.P)&&.15>Math.abs(N-B)&&(K=H)}});if(1==L&&K){const [H,G,N]=K.C;a.G=[(6==K.P?0:H+(r+1)%2*(N+.02)-C-.01)/19+
p[0],(G-B-.01)/19];a.ga=K;v=4}}!m&&a.ga&&Z(a,12,d);a.sa=v}else a.G&&19>=g&&0<a.G[1]&&(a.G[0]=p[0]);a.orientation!=r&&null!=r&&(a.orientation=r,a.qa=e);if((a.Da||a.ra)&&!t&&!n&&(v=e-a.wa,(v/1E3|0)<((v+19)/1E3|0)))if(v=a.Z||0,v<f.length)a.ra?(f[v]=a.la[0],a.la=[]):Z(a,f[v],d,e),a.Z=v+1;else if(a.Z=0,!a.Ta||a.ra)a.wa=0,a.ra=0,a.Da=0;db(b,a.C,y=>{u&&bb(a,21,d,e,()=>3==y.P&&a.J&&!a.J.has(a.W),()=>{eb(b,y);a.J.set(a.W,y)})});a.ka&&(a.sa=10);(f=a.J)&&f.forEach(()=>{});W(b,a)},kb=(a,b,e,d)=>{if(7==b.R)return a.G=
[0,-.015],a.ka=e,0;8==a.R&&d==a.Va&&(a.sa=11);return 1},nb=(a,b,e,d,f,g,k)=>{let q=0;const p=()=>q++,m=ca(b,e,(w,x)=>d(w,x,p));U(m[g][k],f);const u={[15]:S(a,.3,.2,"triangle",500,700,400,"sine",60),[23]:S(a,.2,.2,"triangle",500,2E3,599),[10]:za(a,350,440),[18]:S(a,.2,.1,"sine",1440,2999,999,"sawtooth",200),[19]:S(a,.2,.1,"sine",2999,1440,2E3,"triangle",200),[13]:Ba(a,2E3),[14]:Ba(a,1E3),[25]:S(a,.2,.2,"triangle",300,2E3,599),[22]:S(a,.2,.2,"triangle",200,2E3,599),[21]:S(a,.2,.2,"triangle",700,2E3,
599),[24]:S(a,.2,.2,"triangle",400,2E3,599),[12]:S(a,.4,.1,"triangle",999,300)};for(let w=0;10>w;w++)u[w]=za(a,ea[w%ea.length],fa[(w/ea.length|0)%fa.length]);pa(a);return{La:[g,k],size:[b,e],Qa:m,kb:q,na:0,Ca:f,Ya:u}},Ea={width:32,height:32,images:[[[-16,-16,32,32,1,4],[-16,-16,30,30,0,4],[-14,-14,30,30,2,4],[-14,-14,28,28,1,4]]],ha:[{id:0,I:0,H:[{B:1,D:0,F:16}]}]},Ga=[[30,30,60],[30,30,50],[30,30,40]],Fa={width:16,height:16,images:[[[-7.5,-1.5,15,3,1],[-8,-1,1,2,0],[-7,-2,14,1,0],[7,-1,1,2,2],[-7,
1,14,1,2]]],ha:[{id:0,H:[{B:1,D:0,F:2}],$:[{I:0,H:[{B:1,D:0,F:4}]},{I:0,H:[{B:1,D:0,F:8}]},{I:0,H:[{B:1,D:-6,F:6},{B:0,U:1,V:-1},{B:2,rotation:-Math.PI/2}]},{I:0,H:[{B:1,D:6,F:6},{B:0,U:1,V:-1},{B:2,rotation:-Math.PI/2}]},{I:0},{I:0,H:[{B:1,D:0,F:12}]}]}]},ob=[[40,5,60],[40,5,40],[120,40,30],[40,5,10],[0,100,40]],pb={width:22,height:30,images:[[[0,0,20,26,0],[2,6,16,8,1],[3,0,14,4,3],[3,0,3,4,4],[3,16,2,2,1],[9,16,2,2,1],[15,16,2,2,1],[3,21,2,2,1],[9,21,2,2,1],[15,21,2,2,1]],[[-8,0,8,26,1]],[[-2,
0,4,2,3],[-3,2,8,2,3]],[[-2,0,4,8,3]],[[-.5,-1,1,2,3],[-1,-.5,2,1,3]],[[-5,-4,2,4,1],[15,-4,2,4,1],[-5,-4,22,2,1]]],ha:[{id:0,H:[{B:1,D:-6,F:0}],$:[{id:3,I:2,H:[{B:1,D:0,F:26}]},{id:4,I:2,H:[{B:1,D:14,F:26}]},{id:7,$:[{id:1,I:0,gb:[{id:6,I:3,H:[{B:1,D:18,F:8}]},{id:10,I:5}],$:[{id:8,I:4,H:[{B:1,D:7,F:10}]},{id:9,I:4,H:[{B:1,D:14,F:10}]},{id:12,H:[{B:1,D:10.5,F:6}]}]},{id:2,I:1,$:[{id:5,I:3,H:[{B:1,D:-5,F:8}],$:[{id:11,H:[{B:1,D:0,F:6}]}]}]}]}]}],Ia:[{[0]:[{B:1,D:-6,F:0},{B:2,rotation:Math.PI/20}],
[1]:[{B:0,U:1.2,V:1}],[2]:[{B:0,U:.6,V:1}],[3]:[{B:1,D:0,F:-6},{B:2,rotation:Math.PI/5}],[5]:[{B:2,rotation:-Math.PI/3}],[6]:[{B:2,rotation:Math.PI/3}],[10]:[{B:0,U:.8,V:1},{B:1,D:3,F:0}]},{[0]:[{B:1,D:6,F:0},{B:2,rotation:-Math.PI/20}],[1]:[{B:0,U:.6,V:1}],[2]:[{B:0,U:1.2,V:1}],[3]:[{B:1,D:-4,F:0}],[4]:[{B:1,D:-4,F:-6},{B:2,rotation:Math.PI/5}],[5]:[{B:2,rotation:Math.PI/3}],[6]:[{B:2,rotation:-Math.PI/3}],[10]:[{B:0,U:.7,V:1}]},{[3]:[{B:2,rotation:Math.PI/8}],[4]:[{B:2,rotation:-Math.PI/8}],[5]:[{B:2,
rotation:2*Math.PI/3}],[6]:[{B:2,rotation:2*-Math.PI/3}]},{[7]:[{B:1,D:0,F:-2},{B:0,U:.95,V:1.1}]},{},{[0]:[{B:1,D:-6,F:0},{B:2,rotation:-Math.PI/10}],[5]:[{B:2,rotation:Math.PI/10}],[6]:[{B:2,rotation:-Math.PI/3}]},{[5]:[{B:2,rotation:-Math.PI/2}],[11]:[{B:2,rotation:Math.PI/2}]},{[7]:[,{B:0,U:1.1,V:.8},{B:1,D:0,F:10}],[5]:[{B:2,rotation:-Math.PI/4}]},{[0]:[,{B:2,rotation:-Math.PI/4,Fa:3,Ga:26}],[7]:[{B:0,U:1.2,V:.8},{B:1,D:0,F:10}],[5]:[{B:2,rotation:3*Math.PI/4}],[4]:[{B:2,rotation:Math.PI/4}]},
{[0]:[{B:2,rotation:Math.PI/4,Fa:10,Ga:26}],[7]:[{B:0,U:.9,V:1.2},{B:1,D:0,F:-4}],[5]:[{B:2,rotation:3*Math.PI/2}],[4]:[{B:2,rotation:-Math.PI/4}]},{[5]:[{B:2,rotation:-Math.PI/3}]},{[5]:[{B:2,rotation:3*-Math.PI/4},{B:1,D:0,F:4}]}],aa:{[2]:{M:300,L:[0,1]},[3]:{M:400,L:[2],repeat:1},[1]:{M:1E3,L:[3,4]},[4]:{M:100,L:[5],repeat:1},[5]:{M:300,L:[6]},[6]:{M:200,L:[7]},[7]:{M:180,L:[8,9]},[8]:{M:200,L:[10]},[9]:{M:300,L:[11],repeat:1},[10]:{M:100,L:[2]}}},Ja=()=>{const a=[0,0,4,4],b=[4,4],e=[];let d=6;
const f=(96-4*d)/(d+1);let g=0;for(;d--;)g+=f,e.push([g,-2,4,2,2]),g+=4;return{width:96,height:32,images:[[...e,[0,0,96,26,1,a],[0,0,94,24,0,a],[2,0,94,26,2,a],[2,0,92,24,1,a]],[[0,0,96,6,1,b],[0,0,94,6,0,b],[2,2,94,4,2,b],[2,2,92,4,1,b]]],ha:[{id:0,I:0,H:[{B:1,D:-48,F:6}]},{id:1,I:1,H:[{B:1,D:-48,F:-2}]}],Ia:[{[1]:[{B:1,D:0,F:2}]}],aa:{[11]:{M:100,L:[0],repeat:1}}}},Na=[[210,30,70],[210,20,60],[210,30,50],[0,0,30],[210,30,30],[0,0,100]],Ma={width:32,height:24,images:[[[-16,-12,32,24,2,5],[-15,-11,
30,22,1,4],[1.5,-6.5,12,12,2,6],[2.5,-5.5,12,12,0,6],[2,-6,12,12,3,6],[-13.5,-6,13,8,4],[-5,-3,2,2,5,1],[-11,-3,2,2,5,1]]],ha:[{id:0,I:0,H:[{B:1,D:0,F:12}]},{id:1,H:[{B:1,D:-7.5,F:5.5}]}]},Qa=[[0,40,50],[0,40,40],[0,40,20],[0,0,100]],Pa={width:32,height:32,images:[[[-12,-28,32,16,0],[-12,-28,16,28,0]],[[-9,-10,18,12,1],[-7,-8,14,8,2]],[[-1,-.5,2,1,3],[-.5,-1,1,2,3]],[[-2,-3,4,6,2]],[[-2,0,4,6,2]]],ha:[{id:0,H:[{B:1,D:-10,F:0}],$:[{id:3,I:4,H:[{B:1,D:-4,F:26}]},{id:4,I:4,H:[{B:1,D:4,F:26}]},{id:1,
I:0,H:[{B:1,D:4,F:28}],$:[{id:5,I:3,H:[{B:1,D:18,F:-10}]},{id:6,I:3,H:[{B:1,D:8,F:-10}],$:[{id:8,H:[{B:1,D:0,F:5}]}]},{id:2,I:1,H:[{B:1,D:15,F:-12}],$:[{I:2,H:[{B:1,D:3,F:-4}]},{I:2,H:[{B:1,D:-3,F:-4}]},{id:7,H:[{B:1,D:0,F:-9}]}]}]}]}],Ia:[{[1]:[{B:2,rotation:-Math.PI/20}],[3]:[{B:1,D:0,F:-3}],[2]:[{B:2,rotation:Math.PI/20}]},{[1]:[{B:2,rotation:Math.PI/20}],[4]:[{B:1,D:0,F:-3}],[2]:[{B:2,rotation:-Math.PI/20}]}],aa:{[2]:{M:300,L:[0,1]}}},Wa=[[0,0,100],[0,0,40]],Xa={width:18,height:12,images:[[[-9,
-6,18,12,1,[2,2]],[-8,-5,16,8,0],[-6,-3,12,4,1,2]],[[-1,-1,2,2,2,1]]],ha:[{id:0,I:0,H:[{B:1,D:0,F:6}],$:[{I:1,H:[{B:1,D:-4,F:-1}]},{I:1,H:[{B:1,D:4,F:-1}]}]}]};
onload=()=>{const a=new AudioContext,{Wa:b,height:e,width:d,ab:f,bb:g,cb:k,eb:q}=Va();let p;const m=()=>{p=nb(a,d,e,b,{N:pb,ia:ob,R:0,C:[k+.2,q+1-.8,.6,.8],da:11145103,P:4,oa:1,orientation:1,qa:0,id:-1,Y:1,G:[0,0],O:[0,0,0,0,0],ja:.006,T:[0,0,0,0],Sa:1,inputs:{xa:{},X:{}},J:new Map,W:11,ba:12,la:[],ta:[],va:new Set([28])},f,g)};m();let u,w,x,r;const n=[c,o,h],v=()=>{w=Math.floor(innerWidth/innerHeight<17.2/12.2?innerWidth/17.2:innerHeight/12.2);x=17.2*w;r=12.2*w;c.width=x;c.height=r;u=c.getContext("2d");
u.textAlign="center";u.font="0.5px fantasy";u.lineWidth=1/w;n.forEach(E=>E.setAttribute("style",`width:${x}px;height:${r}px`))};onresize=v;v();const t={};onkeydown=E=>{a.resume();t[E.keyCode]=t[E.keyCode]?t[E.keyCode]:p.na};onkeyup=E=>{t[E.keyCode]=0};let z,y=0;const F=E=>{let D=Math.min((E||0)-(z||0),38)+y;var J=p.Ca.inputs;J.X={};for(let P in la){const A=la[P];J.X[A]=Math.max(J.X[A]||0,t[P]||0)}for(;!(19>D);){D-=19;if(J=19>D)u.clearRect(0,0,x,r),u.save(),u.scale(w,w),u.translate(-.4,-.4),u.beginPath();
gb(u,p,J);J&&u.restore()}y=D;p.Ca.ka&&Q(p.Ca,15,p.na)&&m();qb(p.Ca,p.na);requestAnimationFrame(F);z=E};F()};const qb=(a,b)=>{o.style.opacity=a.ka?"1":"0";a.Ja?(h.style.opacity="1",h.innerHTML=O.map((e,d)=>a.va.has(d)?`<b>${e.Ha||String.fromCharCode(e.K[0])}</b>) ${oa(d)}<br>`:"").join("")):h.style.opacity="0";a.Za>b-3E3?(l.innerHTML=`New ability<br><i>${oa(a.$a).toUpperCase()}`,l.style.opacity="1"):l.style.opacity="0"};</script>